<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="William Arnost and Meisam A. Mansor" />

<meta name="date" content="2019-06-28" />

<title>Case Study 01</title>

<script src="William_Arnost_CaseStudy01_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="William_Arnost_CaseStudy01_files/bootstrap-3.3.6/css/bootstrap.min.css" rel="stylesheet" />
<script src="William_Arnost_CaseStudy01_files/bootstrap-3.3.6/js/bootstrap.min.js"></script>
<script src="William_Arnost_CaseStudy01_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<script src="William_Arnost_CaseStudy01_files/navigation-1.1/tabsets.js"></script>
<script src="William_Arnost_CaseStudy01_files/navigation-1.1/codefolding.js"></script>
<link href="William_Arnost_CaseStudy01_files/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
<script src="William_Arnost_CaseStudy01_files/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
<link href="William_Arnost_CaseStudy01_files/readthedown-0.1/readthedown.css" rel="stylesheet" />
<script src="William_Arnost_CaseStudy01_files/readthedown-0.1/readthedown.js"></script>
<script src="William_Arnost_CaseStudy01_files/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span. { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>


</head>

<body>


<div id="content" data-toggle="wy-nav-shift">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->

<nav id="nav-top" role="navigation" aria-label="top navigation">
    <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
</nav>


<div id="header">
<h1 class="title">Case Study 01</h1>
</div>


<div id="table-of-contents">
    <h2><a href="#content">Case Study 01</a></h2>
    <div id="text-table-of-contents">
      <ul>
      <li><a href="#introduction-us-craft-beer-analysis">Introduction: US Craft Beer Analysis</a></li>
      <li><a href="#eda">0. EDA</a></li>
      <li><a href="#how-many-breweries-are-present-in-each-state">1. How many breweries are present in each state?</a></li>
      <li><a href="#merge-beer-data-with-the-breweries-data.-print-the-first-6-observations-and-the-last-six-observations-to-check-the-merged-file.">2. Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.</a></li>
      <li><a href="#report-the-number-of-nas-in-each-column.">3. Report the number of NA’s in each column.</a></li>
      <li><a href="#compute-the-median-alcohol-content-and-international-bitterness-unit-for-each-state.-plot-a-bar-chart-to-compare.">4. Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.</a></li>
      <li><a href="#which-state-has-the-maximum-alcoholic-abv-beer-which-state-has-the-most-bitter-ibu-beer">5. Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?</a></li>
      <li><a href="#summary-statistics-for-the-abv-variable.">6. Summary statistics for the ABV variable.</a></li>
      <li><a href="#is-there-an-apparent-relationship-between-the-bitterness-of-the-beer-and-its-alcoholic-content-draw-a-scatter-plot.">7. Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot.</a></li>
      <li><a href="#maps">8. MAPS!</a></li>
      <li><a href="#conclusions">9. Conclusions</a></li>
      </ul>
    </div>
</div>

<div id="main">
<div id="introduction-us-craft-beer-analysis" class="section level2">
<h2>Introduction: US Craft Beer Analysis</h2>
<p>This is an analysis of US Craft Beer data. The final analysis is delivered in a 5 minute video whose audience would be someone at the C-Suite level (see Codebook/Readme for video link). In particular, we addressed the analysis to Carlos Brito, the CEO of InBev / Anheuser Busch. The primary data source is two csv files, one on individual craft beers and another containing geographic information on craft breweries. The data was provided to us by Dr. Sadler.</p>
</div>
<div id="eda" class="section level2">
<h2>0. EDA</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">beers &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;Beers.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1-2" title="2">breweries &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;Breweries.csv&quot;</span>)</a></code></pre></div>
<p>We read in two datasets, one which has data on individual beers and another on the names and locations of breweries.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">beers_unique_val_count &lt;-<span class="st"> </span><span class="kw">sapply</span>(beers, <span class="cf">function</span>(x) <span class="kw">length</span>(<span class="kw">unique</span>(x)))</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">kable</span>(beers_unique_val_count, <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;Unique Count&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">full_width =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Unique Count
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:right;">
2304
</td>
</tr>
<tr>
<td style="text-align:left;">
Beer_ID
</td>
<td style="text-align:right;">
2410
</td>
</tr>
<tr>
<td style="text-align:left;">
ABV
</td>
<td style="text-align:right;">
75
</td>
</tr>
<tr>
<td style="text-align:left;">
IBU
</td>
<td style="text-align:right;">
108
</td>
</tr>
<tr>
<td style="text-align:left;">
Brewery_id
</td>
<td style="text-align:right;">
558
</td>
</tr>
<tr>
<td style="text-align:left;">
Style
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
Ounces
</td>
<td style="text-align:right;">
7
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">brew_unique_val_count &lt;-<span class="st"> </span><span class="kw">sapply</span>(breweries, <span class="cf">function</span>(x) <span class="kw">length</span>(<span class="kw">unique</span>(x)))</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">kable</span>(brew_unique_val_count, <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;Unique Count&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">full_width =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Unique Count
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Brew_ID
</td>
<td style="text-align:right;">
558
</td>
</tr>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:right;">
551
</td>
</tr>
<tr>
<td style="text-align:left;">
City
</td>
<td style="text-align:right;">
384
</td>
</tr>
<tr>
<td style="text-align:left;">
State
</td>
<td style="text-align:right;">
51
</td>
</tr>
</tbody>
</table>
<p>Here we are looking at a count of unique values in each column. We can see there are no duplicate beer or brewery IDs, so each row is related to a specific beer or brewery in their respective datasets. It will be good to look at some of the other variables in a bit.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">beers_missing_count &lt;-<span class="st"> </span><span class="kw">sapply</span>(beers, <span class="cf">function</span>(x) <span class="kw">sum</span>(<span class="kw">is.na</span>(x)))</a>
<a class="sourceLine" id="cb4-2" title="2">beers_missing_count &lt;-<span class="st"> </span><span class="kw">cbind</span>(beers_missing_count, beers_missing_count<span class="op">/</span><span class="dv">2410</span>)</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">kable</span>(beers_missing_count, <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;Missing Count&quot;</span>, <span class="st">&quot;Missing Percent&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">full_width =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Missing Count
</th>
<th style="text-align:right;">
Missing Percent
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
Beer_ID
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
ABV
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
0.0257261
</td>
</tr>
<tr>
<td style="text-align:left;">
IBU
</td>
<td style="text-align:right;">
1005
</td>
<td style="text-align:right;">
0.4170124
</td>
</tr>
<tr>
<td style="text-align:left;">
Brewery_id
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
Style
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.0020747
</td>
</tr>
<tr>
<td style="text-align:left;">
Ounces
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">brew_missing_count &lt;-<span class="st"> </span><span class="kw">sapply</span>(breweries, <span class="cf">function</span>(x) <span class="kw">sum</span>(<span class="kw">is.na</span>(x)))</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">kable</span>(brew_missing_count, <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;Missing Count&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">full_width =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Missing Count
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Brew_ID
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
City
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
State
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>These tables present a missing count for each variable. The majority of the missing data is in the IBU variable. We will visualize the missing data later on.</p>
<p>Next we visualize some of the other variables.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">ggplot</span>(beers, <span class="kw">aes</span>(<span class="dt">x =</span> ABV)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Distribution of Alcohol by Volume (ABV)&quot;</span>, </a>
<a class="sourceLine" id="cb6-2" title="2">    <span class="dt">x =</span> <span class="st">&quot;Alcohol by Volume&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Number of Beers&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb6-3" title="3">    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb6-4" title="4">        <span class="dt">vjust =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="William_Arnost_CaseStudy01_files/figure-html/unnamed-chunk-4-1.png" /><!-- --></p>
<p>This is the distribution of the Alcohol by Volume variable. It has a small right skew.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">ggplot</span>(beers, <span class="kw">aes</span>(<span class="dt">x =</span> IBU)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Distribution of International Bitterness Unit (IBU)&quot;</span>, </a>
<a class="sourceLine" id="cb7-2" title="2">    <span class="dt">x =</span> <span class="st">&quot;Bitterness (IBU)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Number of Beers&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb7-3" title="3">    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb7-4" title="4">        <span class="dt">vjust =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="William_Arnost_CaseStudy01_files/figure-html/unnamed-chunk-5-1.png" /><!-- --></p>
<p>The international bitterness unit has a much more skewed distribution. As a reminder it is also missing a lot of data.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">ggplot</span>(beers, <span class="kw">aes</span>(<span class="kw">as.character</span>(Ounces))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Pour Size in Ounces&quot;</span>, </a>
<a class="sourceLine" id="cb8-2" title="2">    <span class="dt">x =</span> <span class="st">&quot;Size in Ounces (oz)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Number of Beers&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb8-3" title="3">    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb8-4" title="4">        <span class="dt">vjust =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="William_Arnost_CaseStudy01_files/figure-html/unnamed-chunk-6-1.png" /><!-- --> There are 7 different sizes of beers in this data set, however most beers either come in 12oz or 16oz sizes.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">styles &lt;-<span class="st"> </span>beers <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Style) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="op">-</span>count)</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">ggplot</span>(<span class="kw">head</span>(styles, <span class="dv">10</span>), <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(Style, count), <span class="dt">y =</span> count)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Top 10 Beer Styles&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Style&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Number of Beers&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>), </a>
<a class="sourceLine" id="cb9-5" title="5">        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="William_Arnost_CaseStudy01_files/figure-html/unnamed-chunk-7-1.png" /><!-- --></p>
<p>This plot shows the top 10 styles of beer from the dataset. IPA and Pale Ale are the the two strongest by a fair margin.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">brewByState &lt;-<span class="st"> </span>breweries <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(State) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="st">    </span><span class="kw">arrange</span>(<span class="op">-</span>count)</a>
<a class="sourceLine" id="cb10-3" title="3">brewByState</a></code></pre></div>
<pre><code># A tibble: 51 x 2
   State count
   &lt;chr&gt; &lt;int&gt;
 1 CO       47
 2 CA       39
 3 MI       32
 4 OR       29
 5 TX       28
 6 PA       25
 7 MA       23
 8 WA       23
 9 IN       22
10 WI       20
# ... with 41 more rows</code></pre>
<p>This is a count of breweries by state. Colorado and California lead with the most breweries</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">combined &lt;-<span class="st"> </span>beers <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(breweries, <span class="dt">by =</span> <span class="kw">c</span>(<span class="dt">Brewery_id =</span> <span class="st">&quot;Brew_ID&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="st">    </span><span class="kw">rename</span>(<span class="dt">Beer =</span> <span class="st">&quot;Name.x&quot;</span>, <span class="dt">Brewery =</span> <span class="st">&quot;Name.y&quot;</span>)</a>
<a class="sourceLine" id="cb12-3" title="3">byState &lt;-<span class="st"> </span>combined <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(State, Brewery_id, ABV, IBU) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(State) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">Brewery_Count =</span> <span class="kw">n_distinct</span>(Brewery_id), <span class="dt">Median_ABV =</span> <span class="kw">median</span>(ABV, </a>
<a class="sourceLine" id="cb12-5" title="5">        <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dt">Median_IBU =</span> <span class="kw">median</span>(IBU, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dt">Max_ABV =</span> <span class="kw">max</span>(ABV, </a>
<a class="sourceLine" id="cb12-6" title="6">        <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dt">Max_IBU =</span> <span class="kw">max</span>(IBU, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<p>Here we combine the data and create a state level summary to help with further analysis.</p>
</div>
<div id="how-many-breweries-are-present-in-each-state" class="section level2">
<h2>1. How many breweries are present in each state?</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">ggplot</span>(<span class="kw">head</span>(brewByState, <span class="dv">10</span>), <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(State, count), <span class="dt">y =</span> count)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Top 10 States with the Most Breweries&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;State&quot;</span>, </a>
<a class="sourceLine" id="cb13-3" title="3">    <span class="dt">y =</span> <span class="st">&quot;Number of Breweries&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>), </a>
<a class="sourceLine" id="cb13-4" title="4">    <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="William_Arnost_CaseStudy01_files/figure-html/unnamed-chunk-10-1.png" /><!-- --></p>
<p>The chart above shows the number of breweries in each state. Colorado, California, Michigan, Oregon, and Texas have the most breweries.</p>
</div>
<div id="merge-beer-data-with-the-breweries-data.-print-the-first-6-observations-and-the-last-six-observations-to-check-the-merged-file." class="section level2">
<h2>2. Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co">## We did the merge in the EDA step</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw">head</span>(combined, <span class="dv">6</span>)</a></code></pre></div>
<pre><code># A tibble: 6 x 10
  Beer   Beer_ID   ABV   IBU Brewery_id Style   Ounces Brewery  City  State
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;
1 Pub B~    1436 0.05     NA        409 Americ~     12 10 Barr~ Bend  OR   
2 Devil~    2265 0.066    NA        178 Americ~     12 18th St~ Gary  IN   
3 Rise ~    2264 0.071    NA        178 Americ~     12 18th St~ Gary  IN   
4 Sinis~    2263 0.09     NA        178 Americ~     12 18th St~ Gary  IN   
5 Sex a~    2262 0.075    NA        178 Americ~     12 18th St~ Gary  IN   
6 Black~    2261 0.077    NA        178 Oatmea~     12 18th St~ Gary  IN   </code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">tail</span>(combined, <span class="dv">6</span>)</a></code></pre></div>
<pre><code># A tibble: 6 x 10
  Beer    Beer_ID   ABV   IBU Brewery_id Style  Ounces Brewery  City  State
  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;
1 Rocky ~    1035 0.075    NA        425 Ameri~     12 Wynkoop~ Denv~ CO   
2 Belgor~     928 0.067    45        425 Belgi~     12 Wynkoop~ Denv~ CO   
3 Rail Y~     807 0.052    NA        425 Ameri~     12 Wynkoop~ Denv~ CO   
4 B3K Bl~     620 0.055    NA        425 Schwa~     12 Wynkoop~ Denv~ CO   
5 Silver~     145 0.055    40        425 Ameri~     12 Wynkoop~ Denv~ CO   
6 Rail Y~      84 0.052    NA        425 Ameri~     12 Wynkoop~ Denv~ CO   </code></pre>
<p>The exact order depends on the procedure, sometimes it applies a sort which changes the top/bottom rows.</p>
</div>
<div id="report-the-number-of-nas-in-each-column." class="section level2">
<h2>3. Report the number of NA’s in each column.</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">missmap</span>(combined, <span class="dt">y.at =</span> <span class="kw">c</span>(<span class="dv">1</span>), <span class="dt">y.labels =</span> <span class="kw">c</span>(<span class="st">&quot;&quot;</span>))</a></code></pre></div>
<p><img src="William_Arnost_CaseStudy01_files/figure-html/unnamed-chunk-12-1.png" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">gg_miss_var</span>(combined, <span class="dt">show_pct =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Percent Missing by Data Field&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>), </a>
<a class="sourceLine" id="cb19-3" title="3">        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="William_Arnost_CaseStudy01_files/figure-html/unnamed-chunk-12-2.png" /><!-- --></p>
<p>These graphs show information about missing data. The first gives a way to compare across observations and variables where the missing data is. The red lines indicate missing. We can see most of the missing data is in the IBU variable, with a few missing in ABV. The second graph shows the percent of missing data in each column.</p>
</div>
<div id="compute-the-median-alcohol-content-and-international-bitterness-unit-for-each-state.-plot-a-bar-chart-to-compare." class="section level2">
<h2>4. Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">ggplot</span>(byState, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(State, Median_ABV), <span class="dt">y =</span> Median_ABV)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Median Alchohol by Volume (ABV) by State&quot;</span>, </a>
<a class="sourceLine" id="cb20-3" title="3">    <span class="dt">x =</span> <span class="st">&quot;State&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Median ABV&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>), </a>
<a class="sourceLine" id="cb20-4" title="4">    <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="William_Arnost_CaseStudy01_files/figure-html/unnamed-chunk-13-1.png" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">ggplot</span>(byState[byState<span class="op">$</span>State <span class="op">!=</span><span class="st"> &quot;SD&quot;</span>, ], <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(State, Median_IBU), </a>
<a class="sourceLine" id="cb21-2" title="2">    <span class="dt">y =</span> Median_IBU)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Median Bitterness (IBU) by State&quot;</span>, </a>
<a class="sourceLine" id="cb21-3" title="3">    <span class="dt">x =</span> <span class="st">&quot;State&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Median IBU&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>), </a>
<a class="sourceLine" id="cb21-4" title="4">    <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="William_Arnost_CaseStudy01_files/figure-html/unnamed-chunk-13-2.png" /><!-- --></p>
<p>These graphs show the median ABV and IBU by state. Kentucky and DC produce the beers with the highest median alchohol by volume. Maine and West Virginia have the highest median bitterness. South Dakota did not have any bitterness observations.</p>
</div>
<div id="which-state-has-the-maximum-alcoholic-abv-beer-which-state-has-the-most-bitter-ibu-beer" class="section level2">
<h2>5. Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># kable(brew_unique_val_count, col.names = c(&#39;Unique Count&#39;)) %&gt;%</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="co"># kable_styling(full_width = FALSE)</span></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="kw">kable</span>(combined[<span class="kw">which.max</span>(combined<span class="op">$</span>ABV), ]) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">full_width =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Beer
</th>
<th style="text-align:right;">
Beer_ID
</th>
<th style="text-align:right;">
ABV
</th>
<th style="text-align:right;">
IBU
</th>
<th style="text-align:right;">
Brewery_id
</th>
<th style="text-align:left;">
Style
</th>
<th style="text-align:right;">
Ounces
</th>
<th style="text-align:left;">
Brewery
</th>
<th style="text-align:left;">
City
</th>
<th style="text-align:left;">
State
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Lee Hill Series Vol. 5 - Belgian Style Quadrupel Ale
</td>
<td style="text-align:right;">
2565
</td>
<td style="text-align:right;">
0.128
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:left;">
Quadrupel (Quad)
</td>
<td style="text-align:right;">
19.2
</td>
<td style="text-align:left;">
Upslope Brewing Company
</td>
<td style="text-align:left;">
Boulder
</td>
<td style="text-align:left;">
CO
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">kable</span>(combined[<span class="kw">which.max</span>(combined<span class="op">$</span>IBU), ]) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">full_width =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Beer
</th>
<th style="text-align:right;">
Beer_ID
</th>
<th style="text-align:right;">
ABV
</th>
<th style="text-align:right;">
IBU
</th>
<th style="text-align:right;">
Brewery_id
</th>
<th style="text-align:left;">
Style
</th>
<th style="text-align:right;">
Ounces
</th>
<th style="text-align:left;">
Brewery
</th>
<th style="text-align:left;">
City
</th>
<th style="text-align:left;">
State
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Bitter Bitch Imperial IPA
</td>
<td style="text-align:right;">
980
</td>
<td style="text-align:right;">
0.082
</td>
<td style="text-align:right;">
138
</td>
<td style="text-align:right;">
375
</td>
<td style="text-align:left;">
American Double / Imperial IPA
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
Astoria Brewing Company
</td>
<td style="text-align:left;">
Astoria
</td>
<td style="text-align:left;">
OR
</td>
</tr>
</tbody>
</table>
<p>Colorado produces the beer “Lee Hill Series Vol. 5” with the highest alcohol content in our dataset at 12.8%. Oregon produces the beer “Bitter Bitch” which is the most bitter beer in our data set with an IBU of 138.</p>
</div>
<div id="summary-statistics-for-the-abv-variable." class="section level2">
<h2>6. Summary statistics for the ABV variable.</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">kable</span>(<span class="kw">as.array</span>(<span class="kw">summary</span>(combined<span class="op">$</span>ABV)), <span class="dt">digits =</span> <span class="dv">3</span>, <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;Stat&quot;</span>, <span class="st">&quot;Value&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">full_width =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Stat
</th>
<th style="text-align:right;">
Value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Min.
</td>
<td style="text-align:right;">
0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
1st Qu.
</td>
<td style="text-align:right;">
0.050
</td>
</tr>
<tr>
<td style="text-align:left;">
Median
</td>
<td style="text-align:right;">
0.056
</td>
</tr>
<tr>
<td style="text-align:left;">
Mean
</td>
<td style="text-align:right;">
0.060
</td>
</tr>
<tr>
<td style="text-align:left;">
3rd Qu.
</td>
<td style="text-align:right;">
0.067
</td>
</tr>
<tr>
<td style="text-align:left;">
Max.
</td>
<td style="text-align:right;">
0.128
</td>
</tr>
<tr>
<td style="text-align:left;">
NA’s
</td>
<td style="text-align:right;">
62.000
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">ggplot</span>(combined[<span class="op">!</span><span class="kw">is.na</span>(combined<span class="op">$</span>ABV), ], <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> ABV)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="fl">0.4</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">shape =</span> <span class="dv">20</span>, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, </a>
<a class="sourceLine" id="cb25-3" title="3">        <span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Alcohol by Volume&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb25-4" title="4">    <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="William_Arnost_CaseStudy01_files/figure-html/unnamed-chunk-15-1.png" /><!-- --></p>
<p>At least 75% of beers have a ABV of less than 6.7%</p>
</div>
<div id="is-there-an-apparent-relationship-between-the-bitterness-of-the-beer-and-its-alcoholic-content-draw-a-scatter-plot." class="section level2">
<h2>7. Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot.</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">ggplot</span>(combined, <span class="kw">aes</span>(<span class="dt">x =</span> IBU, <span class="dt">y =</span> ABV)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm, </a>
<a class="sourceLine" id="cb26-2" title="2">    <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Relationship between Alcohol Content and Bitterness&quot;</span>, </a>
<a class="sourceLine" id="cb26-3" title="3">    <span class="dt">x =</span> <span class="st">&quot;Bitterness&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Alcohol by Volume&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb26-4" title="4">    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb26-5" title="5">        <span class="dt">vjust =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="William_Arnost_CaseStudy01_files/figure-html/unnamed-chunk-16-1.png" /><!-- --></p>
<p>There is a positive relationship between Alcohol Content and Bitterness.</p>
</div>
<div id="maps" class="section level2">
<h2>8. MAPS!</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co">## Code derived from tutorial found at https://socviz.co/maps.html</span></a>
<a class="sourceLine" id="cb27-2" title="2">us_states &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;state&quot;</span>)</a>
<a class="sourceLine" id="cb27-3" title="3">us_states[us_states<span class="op">$</span>region <span class="op">==</span><span class="st"> &quot;district of columbia&quot;</span>, <span class="st">&quot;abb&quot;</span>] &lt;-<span class="st"> &quot;DC&quot;</span></a>
<a class="sourceLine" id="cb27-4" title="4">us_states<span class="op">$</span>abb &lt;-<span class="st"> </span>state.abb[<span class="kw">match</span>(us_states<span class="op">$</span>region, <span class="kw">tolower</span>(state.name))]</a>
<a class="sourceLine" id="cb27-5" title="5">map_withBrew &lt;-<span class="st"> </span>us_states <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(brewByState, <span class="dt">by =</span> <span class="kw">c</span>(<span class="dt">abb =</span> <span class="st">&quot;State&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="st">    </span><span class="kw">rename</span>(<span class="dt">BreweryCount =</span> <span class="st">&quot;count&quot;</span>)</a>
<a class="sourceLine" id="cb27-7" title="7">start_map &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> map_withBrew, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group, </a>
<a class="sourceLine" id="cb27-8" title="8">    <span class="dt">fill =</span> BreweryCount))</a>
<a class="sourceLine" id="cb27-9" title="9">map_<span class="dv">2</span> &lt;-<span class="st"> </span>start_map <span class="op">+</span><span class="st"> </span><span class="kw">geom_polygon</span>(<span class="dt">color =</span> <span class="st">&quot;gray90&quot;</span>, <span class="dt">size =</span> <span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_map</span>(<span class="dt">projection =</span> <span class="st">&quot;albers&quot;</span>, </a>
<a class="sourceLine" id="cb27-10" title="10">    <span class="dt">lat0 =</span> <span class="dv">39</span>, <span class="dt">lat1 =</span> <span class="dv">45</span>)</a>
<a class="sourceLine" id="cb27-11" title="11"></a>
<a class="sourceLine" id="cb27-12" title="12">map_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Brewery Count by State&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_map</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;Brewery Count&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-13" title="13"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>))</a></code></pre></div>
<p><img src="William_Arnost_CaseStudy01_files/figure-html/unnamed-chunk-17-1.png" /><!-- --></p>
</div>
<div id="conclusions" class="section level2">
<h2>9. Conclusions</h2>
<div id="colorado-and-california-have-the-most-craft-breweries" class="section level3">
<h3>Colorado and California have the most craft breweries</h3>
</div>
<div id="ipa-and-pale-ale-are-the-most-popular-styles" class="section level3">
<h3>IPA and Pale Ale are the most popular styles</h3>
</div>
<div id="craft-beers-tend-to-have-alcohol-content-between-5-and-6.7" class="section level3">
<h3>Craft Beers tend to have alcohol content between 5% and 6.7%</h3>
</div>
<div id="there-is-a-positive-relationship-between-alcohol-content-and-bitterness-in-craft-beers" class="section level3">
<h3>There is a positive relationship between alcohol content and bitterness in craft beers</h3>
</div>
<div id="lee-hill-series-volume-5-is-the-most-alcoholic-craft-beer-12.8" class="section level3">
<h3>Lee Hill Series Volume 5 is the most alcoholic craft beer (12.8%)</h3>
</div>
<div id="bitter-bitch-is-the-most-bitter-beer-138-ibu" class="section level3">
<h3>Bitter Bitch is the most bitter beer (138 IBU)</h3>
</div>
</div>
</div>


</div>

<div id="postamble" data-toggle="wy-nav-shift" class="status">
<p class="author"><span class="glyphicon glyphicon-user"></span> William Arnost and Meisam A. Mansor</p>
<p class="date"><span class="glyphicon glyphicon-calendar"></span> 2019-06-28</p>
</div>


<script>
$(document).ready(function () {
 	  });
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
